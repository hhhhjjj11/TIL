# 장바구니
## 데이터필드 연결하기 (데이터 구조 수정)
- 장바구니 : 사용자와 상품의 M대N 관계 
- ManyToManyField이용한다.
- product모델에 다음과같이 user필드를 MTM으로 추가
```python
class SavingProduct(models.Model):

    carted_user = models.ManyToManyField(settings.AUTH_USER_MODEL,  related_name="cart_saving")

    fin_prdt_cd = models.TextField(unique=True) # 금융 상품 코드
    kor_co_nm = models.TextField() # 금융 회사명
    fin_prdt_nm = models.TextField() # 금융 상품명
    etc_note = models.TextField() # 금융 상품 설명
    join_deny = models.IntegerField() # 가입제한  1- 제한 없음, 2-서민전용, 3-일부제한
    join_member = models.TextField() # 가입 대상
    join_way = models.TextField() # 가입 방법
    spcl_cnd = models.TextField() # 우대 조건

```
- 시리얼라이저에서 리드온리 필드로 (사용자가 입력 할 수 없도록)
```python
class DepositProductSerializer(serializers.ModelSerializer):
    depositoptions_set = DepositOptionsSerializer(many = True, read_only=True)
    class Meta:
        model = DepositProduct
        fields = '__all__'
        read_only_fields = ('carted_user',)
```


## 장바구니에 추가하기
```python
# 예금상품 장바구니에 추가
@api_view(['POST'])
def deposit_product_cart(req, fin_prdt_cd):
    product = DepositProduct.objects.get(fin_prdt_cd=fin_prdt_cd)
    product.carted_user.add(req.user)
    product.save()
    serializer = DepositProductSerializer(product)

    return Response(serializer.data)
```

## 장바구니 불러오기
```python
# 예금 장바구니 리스트 불러오기
@api_view(['GET'])
def deposit_cart(req):
    User = get_user_model()
    user = User.objects.get(id=req.user.pk)
    carted_products = user.cart_deposit.all()  # 해당 사용자의 장바구니에 추가된 예금 상품들을 가져옴
    print(carted_products)
    serializers = DepositProductSerializer(carted_products, many=True)

    return Response(serializers.data)

```