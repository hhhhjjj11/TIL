# 3월 21일

# djnago form (장고가 제공하는 폼)

장점 : 유효성검증 할 수 잇음

기타 장점 많음

## 0. 각 앱에 forms.py파일만들어준다.
## 1. forms.py에서 Form Class선언
- (Model Class를 선언하는 것과 비슷.

```python
from django import forms

class ArticleForm(forms.Form):
    title = forms.CharField(max_length=30)
    content = forms.CharField()
```

알고있기. form은 create와 update시에 필요하다는점.

</br>

## 2. views.py 미들웨어에서 form 인스턴스 만들어서 템플릿에 넘겨주기

```python
from .forms import ArticleForm

def create(req):
    if req.method == "POST":
        title = req.POST.get('title')
        content = req.POST.get('content')
        article = Article.objects.create(title=title, content = content)
        context={
            'article': article,
        }
        return redirect('articles:index')
    else:
        form = ArticleForm()
        context = {'form': form }
        return render(req, 'articles/create.html', context)
```

## 3. create.html에서 폼태그 하위에 {{form.as_p}} 넣어주기

```html
<form action={% url 'articles:create' %} method = 'post'>
    {% csrf_token %}
  {{form.as_p}}
    <input type="submit">
</form>
```

- -> input과 label태그 쓸필요 없다.

1. 참고 : Textarea 위젯사용. 컨텐트칸 넓게쓰기

```python
content = forms.CharField(widget =forms.Textarea)
```

</br></br>

# ModelForm

- Model이랑 Form이랑 두개 겹치는게 많아서 합쳐서 한번에 씀

## 1. forms.py에서 Meta 클래스 이용해서 모델적용

```python
from django import forms
from .models import Article

class ArticleForm(forms.ModelForm):

    class Meta:
        model = Article
        fields = '__all__'
        # 아티클모델에서 어느어느필드를 골라서 폼을 만들것인지 정해주는것.
        # 이렇게하면 모든 필드에대한 폼 다만듬
```

- 폼태그를썼을때는 필드들 다시 적어줘야했지만 모델폼을 쓰면 필드들을 다시 지정해줄 필요가 없다.

- 참고 : 필드고르는 문법

```
exclude=('title',)
#의미 :
```

## 2. views.py에서 입력데이터 클래스에 넣어서 인스턴스생성하고 유효성검사 후 저장

- 여전히, 핵심은 필드들을 따로 다뤄줄 필요 없이 모델폼에서 알아서 처리해준다는 점
- 앞단에서 입력 데이터를 폼에 넣어주고, 저장해주는 방식으로 처리 가능.

```python
def create(req):
    if req.method == "POST":
        form = ArticleForm(req.POST)
        if form.is_vaild(): # 입력된 폼이 유효하다면
            article = form.save()
            return redirect('articles:detail', article.pk)
        return redirect('articles:create')
```

모델폼의 여러가지 메서드들

1. is_valid()

- 유효성 검사를 실행하고, 데이터가 유효한지 여부를 boolean으로 반환

</br></br>

# Form vs ModelForm

- 뭐가더 좋은게 아니라 역할이 다름
- Form - 사용자의 입력이 필요하지만 그것이 바로 DB저장에 사용되지 않거나 일부만 사용될 때
  예) 로그인시에 사용자의 데이터를 받아 인증과정에서만 사용 후 별도로 DB에 저장하지는 않는다.

- ModelForm
  - 사용자의 입력을 필요로 하며 입력을 받은 것을 그대로 DB필드에 맞춰 저장할 때

위젯을 작성하는 2가지 방법 (좀 더 활용하고 싶을 경우, 꾸미고 싶을 때)

- 교재 참고

</br></br>

# Static File (정적파일)

- 파일자체가 고정. 서비스 중에도 추가되거나 변경되지 않고 고정.
- 예) 이미지, 자바스크립트, CSS와 같은 미리 준비된 추가 파일
- 장고에서는 이러한 파일들을 static file이라 함

- 장고에서는 staticfiles앱을 통해 정적 파일과 관련된 기능을 제공.

Media File

- 사용자가 웹에서 업로드하는 정적파일
- 유저가 업로드한 모든 정적파일

장고에서 정적파일을 사용하기

1. INSTALLED_APPS 에서 django.contrib.staticfiles.가 포함되어있는지 확인.
2. settings.py 에서 STATIC_URL 정의
3. 앱의 static 폴더에 정적파일 위치시키기
   예) my_app/static/sample_img.jpg
4. 템플릿에서 static템플릿 태그를 사용하여 지정된 경로에 있는 정적 파일의 URL 만들기

```html
{% load static %}
<img src= {% static 'sample_img.jpg' %} alt="sample image">
```

</br></br>

## 실습1. 정적파일 사용해보기: base.html에 CSS파일 사용해주기

1.  settings.py 에서

    ```python
    STATIC_URL = '/static/'
    STATICFILES_DIRS = [
        BASE_DIR/'static'
    ]
    ```

2.  root > static 폴더만들고 하위에 > base.css 파일 추가

3.  base.html에서

    - 제일위에 {% load static %} 넣어주고
    - `<link rel="stylesheet" href= "{% static 'base.css' %}>`

    ```html
    {% load static %}

    (어저구저쩌구)

    <link rel="stylesheet" href= "{% static 'base.css' %}>
    ```

</br></br>

## 실습2. 정적파일 사용해보기 : html에 이미지 넣기

1. 원하는 이미지파일 root > static 에 저장해주고
2. html에서

- 제일위에 {% load static %} 넣어주고
- <img srt={% static 'cat.png' %} alt="">

</br></br>

# 미디어파일

- 사용자 업로드 -> 사용자가 제출 -> 폼태그
  (사용자가 뭘 서버에 준다 -> 무조건 폼태그임)

각반에서 해보자..

개발 단계에서 사용자가 업로드한 미디어 파일 제공하기 (중요 내일 다시)

이미지가지고 CRUD해보기
